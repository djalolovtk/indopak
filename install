down=$EXTERNAL_STORAGE/Download
dpak=$EXTERNAL_STORAGE/Download/pak
quickbms=$PREFIX/share/quickbms
quickbms_dir=$PREFIX/share/quickbms
tx=$HOME/indopak
txz=$PREFIX/bin

NOCOLOR='\033[0m'
LIGHTGREEN='\033[1;32m'
YELLOW='\033[1;33m'

clear
if [[ ! -d "$tx" ]]; then
    mkdir $tx &>/dev/null
    cd $tx
else
    cd $tx
fi

if [[ ! -d "$tx/output" ]]; then
    mkdir -p $tx/output &>/dev/null
    mkdir -p $tx/etc &>/dev/null
    chmod +x pubg.bms 
    mv pubg.bms $tx/etc
fi

chmod +x indopak
yes | cp -rf indopak $txz

cd $down
if [[ -d "pak" ]]; then
    mkdir -p $dpak &>/dev/null
    echo "Copying files from pak..."
    cp -r $down/pak/* $dpak
else
    echo "pak directory not found."
fi

function install {
    echo "Please wait .."
    sleep 2
    cd $tx
    sleep 1
    rm -rf $PREFIX/share/quickbms
    sleep 1
    mkdir $PREFIX/share/quickbms
    sleep 1
    chmod +x quickbms_4gb_files
    yes | cp -rf quickbms_4gb_files $quickbms_dir
    chmod +x quickbms
    yes | cp -rf quickbms $quickbms_dir
    chmod +x etc/pubg.bms indopak
    sleep 1
    printf "\n"
    FILE=$quickbms_dir/quickbms
    if [ -f "$FILE" ]; then
        echo -e "${LIGHTGREEN}Tools are checking the package....${NOCOLOR}"
        sleep 5
    else
        exit
    fi
}

install
clear
echo " ======================= "
echo -e " ${LIGHTGREEN}Installation of indopak completed "
echo " ======================= "
echo " "
echo -e " ${YELLOW}Please type exit and restart your TERMUX ${NOCOLOR}"
echo " "
echo -e " then type ${LIGHTGREEN}indopak ${NOCOLOR}(all lowercase) "
exit
